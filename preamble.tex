\usepackage[a4paper]{geometry}
\usepackage{libertine}
\usepackage[T1]{fontenc}
\usepackage{setspace}
\usepackage{graphicx}
\usepackage[toc,page]{appendix}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{enumitem}
\usepackage{stackengine}
\usepackage{mathtools}
\usepackage{todonotes}
\usepackage{bm}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{float}

\theoremstyle{plain}
\newtheorem{thm}{Theorem}[chapter] % reset theorem numbering for each chapter


\let\otherbegin\begin
\let\otherend\end

\newcommand{\toadd}[1]{\todo[inline]{#1}}

\theoremstyle{plain}
\newtheorem{defn}[thm]{Definition}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{examples}[thm]{Examples}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\csum}{\mathrm{Sum}}
\newcommand{\Sum}{\mathrm{Sum}}
\newcommand{\PosSum}{\mathrm{PosSum}}
\newcommand{\mcolor}{\mathrm{col}}
\newcommand{\mcol}{\mathrm{col}}
\newcommand{\key}{\mathrm{key}}
\renewcommand*{\vec}[1]{\mathbf{#1}}
\newcommand{\diag}{\textrm{diag}}


\DeclarePairedDelimiter\abs{\lvert}{\rvert}%
\DeclarePairedDelimiter\norm{\lVert}{\rVert}%

% Swap the definition of \abs* and \norm*, so that \abs
% and \norm resizes the size of the brackets, and the 
% starred version does not.
\makeatletter
\let\oldabs\abs
\def\abs{\@ifstar{\oldabs}{\oldabs*}}
%
\let\oldnorm\norm
\def\norm{\@ifstar{\oldnorm}{\oldnorm*}}
\makeatother

\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}